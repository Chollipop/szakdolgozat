using Microsoft.EntityFrameworkCore;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace szakdolgozat.Models
{
    [Index(nameof(AssetID))]
    [Index(nameof(VulnerabilityID))]
    [PrimaryKey(nameof(AssetID), nameof(VulnerabilityID))]
    public class AssetVulnerability
    {
        [Key, Column(Order = 0)]
        public int AssetID { get; set; }

        [Key, Column(Order = 1)]
        public int VulnerabilityID { get; set; }

        [ForeignKey("AssetID")]
        public Asset Asset { get; set; }

        [ForeignKey("VulnerabilityID")]
        public Vulnerability Vulnerability { get; set; }

        [Required]
        public int? Probability { get; set; }

        [Required]
        public int? Impact { get; set; }

        [MaxLength(500)]
        public string Action { get; set; } = string.Empty;

        [NotMapped]
        public int Product => (Probability ?? 0) * (Impact ?? 0);
    }
}
